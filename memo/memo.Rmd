---
title: "Project memo"
author: "SereAnalytics"
output: github_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(skimr)
library(janitor)
library(ggplot2)
library(dplyr)
library(ggthemes)
```

## Data Clean Up Steps for Overall Data

### Step 1: The first step is to load our data set and store it in a dataframe called project_data

```{r load-data}
project_data <- read_csv("Data.csv")
glimpse(project_data)
```

### Step 2: The second step is to add a categories column depending on the developmental score that the United Nations has assigned to each country

```{r add-categories}
project_data <- project_data %>%
  mutate(category = case_when(
    Country == "Nigeria" ~ "Low",
    Country == "Pakistan" ~ "Low",
    Country == "Bangladesh" ~ "Medium",
    Country == "Comoros" ~ "Medium",
    Country == "India" ~ "Medium",
    Country == "Kyrgyzstan" ~ "Medium",
    Country == "Brazil" ~ "High",
    Country == "China" ~ "High",
    Country == "Egypt" ~ "High",
    Country == "Fiji" ~ "High",
    Country == "Indonesia" ~ "High",
    Country == "South Africa" ~ "High",
    Country == "Tunisia" ~ "High",
    Country == "Australia" ~ "Very High",
    Country == "Germany" ~ "Very High",
    Country == "Greece" ~ "Very High",
    Country == "Japan" ~ "Very High",
    Country == "Republic of Korea" ~ "Very High",
    Country == "Russian Federation" ~ "Very High",
    Country == "TÃ¼rkiye" ~ "Very High",
    Country == "United States of America" ~ "Very High"
  ))
```

## Step 3: The third step is to modify our data set from a long data set to a wide dataset. This makes it easier for use in later data analysis steps and overall just makes the data easier to work with. This is stored in a new dataframe called project_data_wide

```{r long-to-wide}
project_data_wide <- project_data %>%
  unite("Section_Label", Section, Description, sep = " - ") %>%
  pivot_wider(
    names_from = Section_Label,
    values_from = Value
  )
```


## Step 4: The fourth step is to clean the names of our variables. Because our data comes from a survey, the variables are names with really long descriptions of what the survey questions were asking. This is once again to make the data handling easier. We store this in a new dataframe called project_data_clean

```{r clean-names}
project_data_wide <- project_data_wide %>%
  clean_names()

project_data_clean <- project_data_wide %>%
  rename(
    iso = country_iso,
    country = country,
    category = category,
    mean_age = mean_age_mean_age_of_survey_respondents,
    age_15_17 = age_group_respondents_aged_15_17,
    age_18_35 = age_group_respondents_aged_18_35,
    age_36_59 = age_group_respondents_aged_36_59,
    age_60_plus = age_group_respondents_aged_60,
    female = gender_group_female_respondents,
    male = gender_group_male_respondents,
    other_gender = gender_group_other_respondents,
    edu_primary = education_group_completed_primary_or_less,
    edu_secondary = education_group_completed_secondary,
    edu_university = education_group_completed_university_or_more,
    occ_fulltime = occupation_group_full_time_employee,
    occ_parttime = occupation_group_part_time_employee,
    occ_self = occupation_group_self_employed,
    occ_unemployed = occupation_group_unemployed,
    occ_retired = occupation_group_retired,
    occ_student = occupation_group_student,
    occ_unpaid = occupation_group_unpaid_worker,
    trust_people = trust_in_people_most_people_can_be_trusted,
    trust_ai_confident = trust_in_ai_systems_trust_in_ai_systems_very_confident,
    ai_productivity_likely = ai_impact_ai_will_increase_productivity_likely
  )

```

## Plots

### ggsave example for saving plots

```{r starwars ggsave example}
p1 <- starwars |>
  filter(mass < 1000, 
         species %in% c("Human", "Cerean", "Pau'an", "Droid", "Gungan")) |>
  ggplot() +
  geom_point(aes(x = mass, 
                 y = height, 
                 color = species)) +
  labs(x = "Weight (kg)", 
       y = "Height (m)",
       color = "Species",
       title = "Weight and Height of Select Starwars Species",
       caption = paste("This data comes from the starwars api: https://swapi.py43.com"))


ggsave("example-starwars.png", width = 4, height = 4)

ggsave("example-starwars-wide.png", width = 6, height = 4)
```


#### Plot 1: Trust in People vs. Trust in AI Systems

```{r final_visualization_2, fig.alt= "Scatter plot of the average trust of people vs average trust of AI by development group by the United Nations. Countries with very high development have much more trust in people and much less trust in AI compared to all other development groups."}
ggplot(summary_stats, aes(x = avg_trust_people, y = avg_trust_ai, color = category)) +
  geom_point(size = 4) +
  geom_text(aes(label = category), vjust = -1, color = "black") + 
  labs(
    title = "Trust in People vs. Trust in AI Systems",
    x = "Average Trust in People",
    y = "Average Trust in AI Systems",
    color = "Category"
  ) +
  theme_excel_new() +
  scale_x_continuous(limits = c(10, 22.5)) +
  scale_y_continuous(limits = c(10, 27.5)) +
  theme(
    axis.title.x = element_text(color = "black", size = 12), 
    axis.title.y = element_text(color = "black", size = 12),   
    plot.title = element_text(color = "black", size = 14, face = "bold")
  )
  
```


### Plot 2: Average Trust in AI Systems by Country

```{r final_plot_2, fig.alt= "Horizontal bar chart that shows the trust in AI score for each country in the data set. Egypt has the highest score at 38.3 out of 40 while the United States is the lowest at just 3.5."}
plot_data <- project_data_clean %>%
  arrange(trust_ai_confident) %>%  
  mutate(country = factor(country, levels = country))

plot_for_critique <- ggplot(plot_data, aes(x = country, y = trust_ai_confident)) +
  geom_col(fill = "#2E86AB", width = 0.7) +
  geom_text(aes(label = round(trust_ai_confident, 1)),
            hjust = -0.1, size = 3.5, color = "black") + 
  labs(
    title = "Average Trust in AI Systems by Country",
    subtitle = "Confidence scores represent average trust ratings",
    x = NULL,
    y = "Average Trust in AI Systems"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
    plot.subtitle = element_text(size = 11, hjust = 0.5, color = "grey30"),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank()
  ) +
  scale_y_continuous(limits = c(0, max(plot_data$trust_ai_confident) * 1.1)) +
  coord_flip()
```

### Plot 3: Perceived Likelihood that AI Will Increase Productivity

```{r final_plot_3, fig.alt= "Heat map graph showing how optimistic countries in different development groups are about how AI will affect productivity. Countries in the medium development group seem to, on average, have the most faith in AI increasing productivity."}
project_data_clean$category <- factor(
  project_data_clean$category,
  levels = c("Low", "Medium", "High", "Very High")
)

heatmap_data <- project_data_clean %>%
  select(country, category, ai_productivity_likely) %>%
  group_by(category) %>%
  mutate(country = fct_reorder(country, ai_productivity_likely)) %>%
  ungroup()

max_val <- max(heatmap_data$ai_productivity_likely, na.rm = TRUE)

ggplot(
  heatmap_data,
  aes(
    x = category,
    y = country,
    fill = ai_productivity_likely
  )
) +
  geom_tile(color = "white", linewidth = 0.6) +

  facet_wrap(~ category, scales = "free_y", ncol = 2) +

  scale_fill_gradientn(
    colors = c("#dbe9f6", "#6baed6", "#2171b5"),
    values = scales::rescale(c(0, max_val * 0.5, max_val)),
    name = paste0("AI Productivity\nLikelihood\n(max = ", max_val, ")")
  ) +

  labs(
    title = "Perceived Likelihood that AI Will Increase Productivity",
    subtitle = "Countries grouped by Human Development Category",
    x = NULL,
    y = NULL
  ) +

  theme_minimal(base_size = 12) +
  theme(
    strip.text = element_text(face = "bold", size = 13),
    panel.spacing = unit(1.2, "lines"),

    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(),

    axis.text.y = element_text(size = 10, face = "bold"),
    legend.position = "right",

    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    plot.subtitle = element_text(size = 12, color = "grey40", hjust = 0.5)
  )
```

### Plot 4: World Map by Development Category

```{r final_plot_4, fig.alt= "World map that highlights which countries are represented in our data set. The countries in the darkest blue are in the very high development group while the lightest blue countires are in the low development group. This map shows how we have data for a country from every populated continent but still do not have data for many countries."}

world <- ne_countries(scale = "medium", returnclass = "sf")

world_data <- world %>%
  left_join(project_data_clean, by = c("name" = "country"))

colors <- c(
  "Very High" = "#08519c",   
  "High" = "#2171b5", 
  "Medium" = "#6baed6",
  "Low" = "#dbe9f6",
  "No Data" = "gray"  
)

ggplot(world_data) +
  geom_sf(aes(fill = ifelse(is.na(category), "No Data", category)), color = "white", size = 0.2) +
  scale_fill_manual(values = colors, name = "Development Level") +
  labs(
    title = "World Map by Development Category",
    subtitle = "Gray countries indicate missing data"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
    plot.subtitle = element_text(size = 11, hjust = 0.5, color = "grey30"),
    legend.position = "bottom"
  )

```

